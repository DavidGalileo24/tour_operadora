<?php defined('BASEPATH') OR exit ('No direct script access allowed');

class login_model extends CI_Model{

	public function validar($datos){
		//validamos que el usuario y la clave enviada pertenezcan al usuario
		$this->db->where('usuario',$datos['usuario']);
		$this->db->where('clave',$datos['clave']);
		$exe = $this->db->get('usuario');

		if ($this->db->affected_rows() > 0) {
			return $exe->row();
		}else{
			return false;
		}

	}
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------//
	public function cambiar_clave($datos){
		$id = $this->session->userdata('id');
		$this->db->select('clave');
		$this->db->where('id_empleado',$id);
		$exe = $this->db->get('usuario');

		$result = $exe->row(); 

		
		if($result->clave != $datos["actual"]){
			return "no es clave actual";
		}

		if($result->clave == $datos["nueva"]){
			return "misma clave";
		}
		
		$this->db->where('id_empleado',$id);
		$this->db->set('clave',$datos["nueva"]);
		$this->db->update('usuario');
		if($this->db->affected_rows() > 0){
			return "ok";
		}else{
			return "error";
		}
		
	}
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------------------------------------------------------------//
}